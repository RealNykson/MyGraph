--Alle Anlagenteile mit der Gruppierung ProcessCell
select unit.nKey, datax.szName, unit.nProcessCellLink, x.szName
from tblItpProcessUnit unit
join tblCPDataX datax on datax.nKey = unit.nDataXLink
join tblItpProcessCell cell on cell.nKey = unit.nProcessCellLink
join tblCPDataX x on x.nKey = cell.nDataXLink
where unit.nProcessCellLink = 39 --Filter auf eine Anlage (kann entfernt werden für alle Anlagen, dann ist es aber ganz viel)
 
--Alle Verbindungen zwischen Quellanlagenteilen und Zielanlagenteilen und welcher Transferanlagenteil die Verbindung ausführt
select nTransferUnitLink, nSourceProcessUnitLink, nDestinationProcessUnitLink 
from tblVDProcessUnitRelation rel
join tblItpProcessUnit unit on unit.nKey = rel.nTransferUnitLink
where unit.nProcessCellLink = 39